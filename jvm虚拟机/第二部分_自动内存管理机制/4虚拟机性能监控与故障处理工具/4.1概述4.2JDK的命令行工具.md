## 4.1概述

+ 给一个系统定位问题时，知识、经验是关键基础，数据是依据，工具是运用知识处理数据的手段
+ 数据包括：运行日志、异常堆栈、GC日志、线程快照、堆转储快照等

## 4.2　JDK的命令行工具

+ sun jdk 监控和故障处理工具

|                 名称                  | 主要作用                                                     |
| :-----------------------------------: | ------------------------------------------------------------ |
|     jps(JVM Process Status Tool)      | 显示指定系统内所有的HotSpot虚拟机进程                        |
| jstat(JVM Statistics Monitoring Tool) | 用于收集HotSpot虚拟机各方面的运行数据                        |
|  jinfo(Configuration Info for Java)   | 显示虚拟机配置信息                                           |
|       jmap(Memory Map for Java)       | 生成虚拟机的内存转储快照(headdump文件)                       |
|      jhat(JVM Heap Dump Browser)      | 用于分析headdump文件，它会建立一个HTTP/HTML服务器，让用户可以在浏览器上查看分析结果 |
|     jstack(Stack Trace for Java)      | 显示虚拟机的线程快照                                         |

### 4.2.1　jsp:虚拟机进程状况工具

+ 功能和linux中的ps命令类似：列出正在运行的虚拟机进程，并显示虚拟机执行主类(main class,main()函数所在的类)名称以及这些进程的本地虚拟机唯一id(local virtual machine identifier LVMID)

### 4.2.2 jstat:虚拟机统计信息监视工具

+ jstat用于监视虚拟机各种运行状态信息
+ 可以显示本地或者远程虚拟机进程中的类装载、内存、垃圾收集、JIT编译等运行数据
+ 适用于没有可视化界面的纯文本管理方式

### 4.2.3 jinfo: java配置信息工具

* 可以实时的查看和调整虚拟机各项参数

### 4.2.4 jmap:java内存映像工具

+ 用于生成对转储快照
+ 还可以查询finalize执行队列、java堆和永久代的详细信息，如空间使用率、当前用的是哪种收集器等。

### 4.2.5 jhat:虚拟机堆转储快照分析工具

* 与jmap搭配使用，来分析java生成的堆转储快照
* 不过因为功能简单，一般不用它，而将dump文件复制到其他有可视化界面的服务器上分析

### 4.2.6 jstack: java堆栈跟踪工具

+ jstack命令用于生成虚拟机当前时刻的线程快照(threaddump)
+ 线程快照就是当前虚拟机内每一条线程正在执行的方法堆栈的集合
+ 生成线程快照的主要目的是定位线程出现长时间停顿的原因；线程停顿时通过jstack来查看各个线程的调用堆栈，就可以知道没有响应的线程到底在后台做什么，或者等待什么资源

### 4.2.7　HSDIS:JIT生成代码反汇编

+ 一个官方推荐的hotspot虚拟机JIT编译代码的反汇编插件，可以把被JIT动态编译的代码输出成汇编，编于程序分析。