+ java提倡的自动内存管理可以归结为自动化的解决了两个问题
  + 给对象分配内存
  + 回收分配给对象的内存
+ 对象内存分配基本就是在堆上分配，接下来是对象内存分配的几条原则：

### 3.6.1 对象优先在Eden分配

+ 对象优先在Eden分配，如果Eden区没有内存，发动一次minor GC
  + minor GC:新生代回收，频繁且块
  + major GC / Full GC:老年代回收，不频繁且比minor gc慢10倍

### 3.6.2 大对象直接进入老年代

+ 大对象直接进入老年代：因为大对象往往导致新生代频繁发生gc

### 3.6.3　长期存活的对象将进入老年代

+ 长期存活的对象将进入老年代：给每个对象定义一个age计数器，对象在Eden出生，每熬过一次minor gc，年龄增加一岁，当增加到一定岁数时，移到老年代

### 3.6.4动态对象年龄判定

+ 如果在survivor空间中相同年龄所有对象大小的综合大于surviovr空间的一半，年龄大于等于该年龄的对象直接进入老年代

### 3.6.5空间分配担保

+ 用老年代的空间来担保，所以要检查老年代的剩余空间是不是够大

+ 在发生minor GC之前，虚拟机先检查老年代最大可用的连续空间是否大于新生代所有对象总空间

  if(true){

  ​	//可以确保minor GC成功

  }else{

  ​	if(HandlePromotionFailure==允许担保失败&&老年代最大的连续空间>历次晋升到老年代对象的平均大小){

  ​	//冒险进行minor GC

  }else{	//上述条件不满足或者冒险失败都进行full GC

  ​	//Full GC

  }

  }